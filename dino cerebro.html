<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cerebro con Preguntas</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            background-color: #ffffff;
            margin: 0;
            padding: 20px;
            color: #000000;
            overflow-x: hidden;
            touch-action: manipulation;
            transition: background-color 1s, color 1s;
        }
        
        body.night-mode {
            background-color: #000000;
            color: #ffffff;
        }
        
        h1 {
            color: #000000;
            margin-bottom: 10px;
            font-size: 1.8rem;
            transition: color 1s;
        }
        
        body.night-mode h1 {
            color: #ffffff;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            transition: background-color 1s, box-shadow 1s;
        }
        
        body.night-mode .container {
            background-color: #222222;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
        }
        
        .game-container {
            position: relative;
            margin: 20px auto;
            width: 100%;
            max-width: 600px;
            height: 200px;
            border: 2px solid #cccccc;
            border-radius: 5px;
            overflow: hidden;
            background-color: #ffffff;
            transition: background-color 1s, border-color 1s;
        }
        
        body.night-mode .game-container {
            background-color: #000000;
            border-color: #444444;
        }
        
        /* Figura del cerebro: Imagen B&W */
        .dino {
            position: absolute;
            bottom: 0;
            left: 50px;
            width: 40px;
            height: 40px;
            transition: bottom 0.3s;
            z-index: 10;
        }
        .dino img {
            width: 100%;
            height: 100%;
            filter: grayscale(100%);
        }
        
        /* Obstáculos psicológicos */
        .obstacle {
            position: absolute;
            bottom: 0;
            width: 30px;
            height: 40px;
            background-color: transparent;
            z-index: 5;
        }
        
        .obstacle.ansiedad {
            background-color: #ff6b6b;
        }
        
        .obstacle.estres {
            background-color: #ffa500;
        }
        
        .obstacle.depresion {
            background-color: #6a5acd;
        }
        
        .obstacle.trauma {
            background-color: #8b4513;
        }
        
        .obstacle.fobia {
            background-color: #800080;
        }
        
        .ground {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 10px;
            background-color: #cccccc;
            z-index: 1;
            transition: background-color 1s;
        }
        
        body.night-mode .ground {
            background-color: #333333;
        }
        
        .cloud {
            position: absolute;
            width: 60px;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            z-index: 1;
            transition: background-color 1s;
        }
        
        body.night-mode .cloud {
            background-color: #444444;
        }
        
        /* Frases cayendo */
        .falling-phrase {
            position: absolute;
            top: -20px;
            font-size: 14px;
            color: #666666;
            font-weight: bold;
            animation: fall 3s linear forwards;
            pointer-events: none;
            z-index: 2;
            transition: color 1s;
        }
        
        body.night-mode .falling-phrase {
            color: #aaaaaa;
        }
        
        @keyframes fall {
            to {
                top: 200px;
                opacity: 0;
            }
        }
        
        .score {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 18px;
            font-weight: bold;
            color: #000000;
            z-index: 10;
            transition: color 1s;
        }
        
        body.night-mode .score {
            color: #ffffff;
        }
        
        .wrong-answers {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 16px;
            font-weight: bold;
            color: #000000;
            z-index: 10;
            transition: color 1s;
        }
        
        body.night-mode .wrong-answers {
            color: #ffffff;
        }
        
        .speed-indicator {
            position: absolute;
            top: 40px;
            right: 10px;
            font-size: 14px;
            color: #000000;
            z-index: 10;
            transition: color 1s;
        }
        
        body.night-mode .speed-indicator {
            color: #ffffff;
        }
        
        .question-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }
        
        .question-content {
            background-color: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            animation: popIn 0.3s;
            transition: background-color 1s;
        }
        
        body.night-mode .question-content {
            background-color: #333333;
        }
        
        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .question-text {
            font-size: 18px;
            margin-bottom: 20px;
            color: #000000;
            transition: color 1s;
        }
        
        body.night-mode .question-text {
            color: #ffffff;
        }
        
        .answer-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .answer-btn {
            padding: 12px;
            background-color: #e0e0e0;
            color: #000000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.2s, color 1s;
        }
        
        .answer-btn:hover {
            background-color: #b0b0b0;
        }
        
        .answer-btn.correct {
            background-color: #666666;
            color: white;
        }
        
        .answer-btn.incorrect {
            background-color: #cccccc;
        }
        
        .game-over {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(102, 102, 102, 0.9);
            color: #ffffff;
            padding: 20px;
            border-radius: 10px;
            font-size: 24px;
            font-weight: bold;
            animation: fadeIn 0.5s;
            z-index: 20;
        }
        
        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
        
        .controls {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        button {
            padding: 10px 20px;
            background-color: #e0e0e0;
            color: #000000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.2s, color 1s;
            min-width: 120px;
        }
        
        button:hover {
            background-color: #b0b0b0;
        }
        
        .instructions {
            margin-top: 20px;
            color: #666666;
            font-size: 14px;
            transition: color 1s;
        }
        
        body.night-mode .instructions {
            color: #aaaaaa;
        }
        
        .pulse {
            animation: pulse 0.5s;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* Animación de cubos para game over */
        .cube-animation {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            z-index: 200;
            overflow: hidden;
        }
        
        .cube {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #fff;
            opacity: 0;
            animation: cubeFall 2s forwards;
        }
        
        @keyframes cubeFall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        .final-game-over {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            z-index: 300;
            color: white;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            animation: fadeIn 1s;
        }
        
        .final-game-over h2 {
            font-size: 3rem;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }
        
        .final-game-over p {
            font-size: 1.5rem;
            margin-bottom: 30px;
        }
        
        .tap-to-restart {
            padding: 15px 30px;
            background-color: #fff;
            color: #000;
            border: none;
            border-radius: 5px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            animation: pulse 1.5s infinite;
        }
        
        .safe-zone {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 10px;
            background-color: #90EE90;
            z-index: 3;
            display: none;
        }
        
        /* Media queries para móviles */
        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            .game-container {
                height: 150px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .question-text {
                font-size: 16px;
            }
            
            .answer-btn {
                padding: 10px;
                font-size: 14px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                width: 100%;
                max-width: 200px;
            }
            
            .final-game-over h2 {
                font-size: 2rem;
            }
            
            .final-game-over p {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Cerebro con Preguntas</h1>
        <p>Salta sobre los obstáculos psicológicos y responde correctamente para continuar</p>
        
        <div class="game-container">
            <div class="score">Puntuación: <span id="score">0</span></div>
            <div class="wrong-answers">Fallos: <span id="wrongAnswers">0</span>/3</div>
            <div class="speed-indicator">Velocidad: <span id="speed">5</span></div>
            <div class="dino" id="dino">
                <img src="https://as1.ftcdn.net/v2/jpg/03/71/03/18/1000_F_371031810_ITtkrFVvENh8t3Hr51QwMgKM8zcyFRGN.jpg" alt="Cerebro">
            </div>
            <div class="ground"></div>
            <div class="safe-zone" id="safeZone"></div>
            <div class="game-over" id="gameOver">¡Colisión! Responde para continuar</div>
        </div>
        
        <div class="controls">
            <button id="startBtn">Iniciar Juego</button>
            <button id="jumpBtn">Saltar (Espacio)</button>
            <button id="pauseBtn">Pausa</button>
        </div>
        
        <div class="instructions">
            <p>Presiona ESPACIO para iniciar y saltar. Evita los obstáculos psicológicos.</p>
            <p><strong>Obstáculos:</strong> 
                <span style="color:#ff6b6b">Ansiedad</span> | 
                <span style="color:#ffa500">Estrés</span> | 
                <span style="color:#6a5acd">Depresión</span> | 
                <span style="color:#8b4513">Trauma</span> | 
                <span style="color:#800080">Fobia</span>
            </p>
        </div>
        
        <div class="question-modal" id="questionModal">
            <div class="question-content">
                <div class="question-text" id="questionText"></div>
                <div class="answer-options" id="answerOptions"></div>
                <div id="resultMessage"></div>
            </div>
        </div>
        
        <div class="cube-animation" id="cubeAnimation"></div>
        
        <div class="final-game-over" id="finalGameOver">
            <h2>GAME OVER</h2>
            <p>Has fallado 3 preguntas</p>
            <button class="tap-to-restart" id="tapToRestart">TAP TO NEW GAME</button>
        </div>
    </div>

    <script>
        // Elementos del DOM
        const dino = document.getElementById('dino');
        const gameContainer = document.querySelector('.game-container');
        const scoreElement = document.getElementById('score');
        const wrongAnswersElement = document.getElementById('wrongAnswers');
        const speedElement = document.getElementById('speed');
        const gameOverElement = document.getElementById('gameOver');
        const safeZone = document.getElementById('safeZone');
        const questionModal = document.getElementById('questionModal');
        const questionText = document.getElementById('questionText');
        const answerOptions = document.getElementById('answerOptions');
        const resultMessage = document.getElementById('resultMessage');
        const startBtn = document.getElementById('startBtn');
        const jumpBtn = document.getElementById('jumpBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const cubeAnimation = document.getElementById('cubeAnimation');
        const finalGameOver = document.getElementById('finalGameOver');
        const tapToRestart = document.getElementById('tapToRestart');
        const body = document.body;

        // Variables del juego
        let score = 0;
        let isJumping = false;
        let isGameOver = false;
        let isPaused = false;
        let gameSpeed = 5;
        let obstacles = [];
        let clouds = [];
        let gameInterval;
        let obstacleInterval;
        let cloudInterval;
        let phraseInterval;
        let gameStarted = false;
        let wrongAnswersCount = 0;
        let safeZoneActive = false;
        let nightModeActive = false;

        // Tipos de obstáculos psicológicos
        const obstacleTypes = [
            { type: 'ansiedad', color: '#ff6b6b', description: 'Ansiedad: Estado de inquietud y preocupación excesiva' },
            { type: 'estres', color: '#ffa500', description: 'Estrés: Respuesta fisiológica a situaciones desafiantes' },
            { type: 'depresion', color: '#6a5acd', description: 'Depresión: Trastorno del estado de ánimo caracterizado por tristeza profunda' },
            { type: 'trauma', color: '#8b4513', description: 'Trauma: Experiencia emocionalmente dolorosa que deja secuelas psicológicas' },
            { type: 'fobia', color: '#800080', description: 'Fobia: Miedo intenso e irracional a objetos o situaciones específicas' }
        ];

        // NUEVAS PREGUNTAS (como solicitaste)
        let questions = [
            {
                question: "¿Qué estructuras cerebrales están implicadas en la regulación de la conducta, la emoción y la cognición?",
                correctAnswer: "El sistema límbico, la corteza prefrontal y los ganglios basales están implicados en la regulación emocional, la toma de decisiones y la ejecución de conductas.",
                wrongAnswers: [
                    "El cerebelo, el tálamo y el hipotálamo son las únicas estructuras implicadas en estas funciones",
                    "Solo la corteza cerebral está implicada en la regulación de la conducta y las emociones",
                    "El tronco encefálico es la estructura principal implicada en la cognición y emoción"
                ]
            },
            {
                question: "¿Qué papel desempeñan los neurotransmisores implicados en la modulación de las emociones y los procesos cognitivos?",
                correctAnswer: "Neurotransmisores como la dopamina, serotonina y noradrenalina están implicados en la motivación, el estado de ánimo y la atención.",
                wrongAnswers: [
                    "Los neurotransmisores solo están implicados en el movimiento muscular, no en las emociones",
                    "La acetilcolina es el único neurotransmisor implicado en procesos cognitivos",
                    "Los neurotransmisores no tienen ninguna implicación en las emociones humanas"
                ]
            },
            {
                question: "¿Cómo se encuentra implicado el sistema nervioso central en la integración de la información sensorial y la producción de conductas adaptativas?",
                correctAnswer: "El sistema nervioso central integra la información sensorial y está implicado en generar respuestas conductuales adecuadas al entorno.",
                wrongAnswers: [
                    "El sistema nervioso central solo procesa información visual, no otras modalidades sensoriales",
                    "La integración sensorial ocurre exclusivamente en la médula espinal, no en el SNC",
                    "El SNC no está implicado en la producción de conductas, solo en reflejos simples"
                ]
            },
            {
                question: "¿Qué procesos hormonales están implicados en la expresión y regulación de las emociones?",
                correctAnswer: "Hormonas como el cortisol, la adrenalina y la oxitocina están implicadas en la respuesta al estrés, la activación y el vínculo afectivo.",
                wrongAnswers: [
                    "Solo las hormonas tiroideas están implicadas en la regulación emocional",
                    "Las hormonas no tienen ninguna implicación en las emociones humanas",
                    "La insulina es la principal hormona implicada en la regulación emocional"
                ]
            },
            {
                question: "¿De qué manera los factores genéticos y ambientales están implicados en la configuración de la conducta y la cognición?",
                correctAnswer: "Ambos factores están implicados en el desarrollo cerebral y la expresión de habilidades cognitivas y conductuales.",
                wrongAnswers: [
                    "Solo los factores genéticos están implicados en la configuración de la conducta",
                    "Los factores ambientales no tienen ninguna implicación en el desarrollo cognitivo",
                    "La conducta y cognición están determinadas exclusivamente por la alimentación"
                ]
            }
        ];

        // Frases psicológicas graciosas
        const psychologyPhrases = [
            "El cerebro es como un WiFi: a veces se desconecta.",
            "Mi lóbulo frontal dice 'no' a las malas decisiones.",
            "Pensar demasiado activa el modo 'overthink'.",
            "El estrés es como un invitado no deseado.",
            "La memoria es selectiva, como mi ex.",
            "Mi amígdala está en modo alerta máxima.",
            "La dopamina me engaña con recompensas inmediatas.",
            "¿Eso es un sesgo cognitivo o simplemente tengo razón?",
            "Mi cerebro prefiere la gratificación instantánea.",
            "La procrastinación es mi superpoder no reconocido.",
            "Mi hipocampo olvidó dónde dejé las llaves.",
            "La serotonina está de vacaciones hoy.",
            "¿Eso fue un dejà vu o solo glitch cerebral?",
            "Mi corteza prefrontal necesita un reinicio.",
            "La ansiedad es mi compañera de viaje no invitada."
        ];

        // Inicializar el juego
        function initGame() {
            score = 0;
            wrongAnswersCount = 0;
            isGameOver = false;
            isPaused = false;
            gameSpeed = 5;
            obstacles = [];
            clouds = [];
            nightModeActive = false;
            body.classList.remove('night-mode');
            scoreElement.textContent = score;
            wrongAnswersElement.textContent = wrongAnswersCount;
            speedElement.textContent = gameSpeed;
            gameOverElement.style.display = 'none';
            finalGameOver.style.display = 'none';
            cubeAnimation.style.display = 'none';
            safeZone.style.display = 'none';
            dino.style.bottom = '0';
            
            // Limpiar elementos
            document.querySelectorAll('.obstacle').forEach(el => el.remove());
            document.querySelectorAll('.cloud').forEach(el => el.remove());
            document.querySelectorAll('.falling-phrase').forEach(el => el.remove());
            document.querySelectorAll('.cube').forEach(el => el.remove());
            
            // Detener intervalos
            clearInterval(gameInterval);
            clearInterval(obstacleInterval);
            clearInterval(cloudInterval);
            clearInterval(phraseInterval);
            
            // Iniciar intervalos
            gameInterval = setInterval(updateGame, 20);
            obstacleInterval = setInterval(createObstacle, 1500);
            cloudInterval = setInterval(createCloud, 3000);
        }

        // Actualizar el juego
        function updateGame() {
            if (isPaused || isGameOver) return;
            
            score++;
            scoreElement.textContent = score;
            
            // Aumentar velocidad cada 100 puntos
            if (score % 100 === 0) {
                gameSpeed += 0.5;
                speedElement.textContent = gameSpeed.toFixed(1);
            }
            
            // Lluvia de frases si score > 2000
            if (score > 2000 && !phraseInterval) {
                phraseInterval = setInterval(createFallingPhrase, 1500);
            }
            
            // Activar modo nocturno si score > 3500
            if (score > 3500 && !nightModeActive) {
                activateNightMode();
            }
            
            // Mover obstáculos
            for (let i = obstacles.length - 1; i >= 0; i--) {
                const obstacle = obstacles[i];
                const currentLeft = parseInt(obstacle.element.style.left) || gameContainer.offsetWidth;
                obstacle.element.style.left = (currentLeft - gameSpeed) + 'px';
                
                if (checkCollision(dino, obstacle.element)) {
                    gameOver();
                    return;
                }
                
                if (parseInt(obstacle.element.style.left) < -30) {
                    obstacle.element.remove();
                    obstacles.splice(i, 1);
                }
            }
            
            // Mover nubes
            for (let i = clouds.length - 1; i >= 0; i--) {
                const cloud = clouds[i];
                const currentLeft = parseInt(cloud.element.style.left) || gameContainer.offsetWidth;
                cloud.element.style.left = (currentLeft - (gameSpeed / 2)) + 'px';
                
                if (parseInt(cloud.element.style.left) < -60) {
                    cloud.element.remove();
                    clouds.splice(i, 1);
                }
            }
        }

        // Activar modo nocturno
        function activateNightMode() {
            nightModeActive = true;
            body.classList.add('night-mode');
        }

        // Crear obstáculo (problema psicológico)
        function createObstacle() {
            if (isPaused || isGameOver || safeZoneActive) return;
            
            // Ajustar la distancia entre obstáculos según la velocidad
            const minDistance = 300 - (gameSpeed * 20);
            const maxDistance = 500 - (gameSpeed * 25);
            const distance = Math.max(minDistance, Math.random() * maxDistance);
            
            // Seleccionar tipo de obstáculo aleatorio
            const obstacleType = obstacleTypes[Math.floor(Math.random() * obstacleTypes.length)];
            
            const obstacle = document.createElement('div');
            obstacle.className = `obstacle ${obstacleType.type}`;
            obstacle.style.left = (gameContainer.offsetWidth + distance) + 'px';
            obstacle.title = obstacleType.description;
            
            // Añadir símbolo representativo
            obstacle.innerHTML = `
                <div style="width:100%; height:100%; display:flex; align-items:center; justify-content:center; color:white; font-weight:bold; font-size:12px;">
                    ${obstacleType.type.charAt(0).toUpperCase()}
                </div>
            `;
            
            gameContainer.appendChild(obstacle);
            
            obstacles.push({ 
                element: obstacle,
                type: obstacleType.type
            });
        }

        // Crear nube
        function createCloud() {
            if (isPaused || isGameOver) return;
            
            const cloud = document.createElement('div');
            cloud.className = 'cloud';
            cloud.style.top = Math.random() * 60 + 'px';
            cloud.style.left = gameContainer.offsetWidth + 'px';
            gameContainer.appendChild(cloud);
            
            clouds.push({ element: cloud });
        }

        // Crear frase cayendo
        function createFallingPhrase() {
            if (isPaused || isGameOver) return;
            
            const phrase = document.createElement('div');
            phrase.className = 'falling-phrase';
            phrase.textContent = psychologyPhrases[Math.floor(Math.random() * psychologyPhrases.length)];
            phrase.style.left = Math.random() * (gameContainer.offsetWidth - 100) + 'px';
            gameContainer.appendChild(phrase);
            
            // Remover después de la animación
            setTimeout(() => phrase.remove(), 3000);
        }

        // Verificar colisión
        function checkCollision(dino, obstacle) {
            const dinoRect = dino.getBoundingClientRect();
            const obstacleRect = obstacle.getBoundingClientRect();
            
            // Ajustar la detección de colisión para que sea más precisa
            return !(dinoRect.right < obstacleRect.left + 10 || 
                     dinoRect.left > obstacleRect.right - 10 || 
                     dinoRect.bottom < obstacleRect.top + 10 || 
                     dinoRect.top > obstacleRect.bottom - 10);
        }

        // Saltar
        function jump() {
            if (isJumping || isGameOver || isPaused) return;
            isJumping = true;
            dino.style.bottom = '60px';
            setTimeout(() => {
                dino.style.bottom = '0';
                setTimeout(() => {
                    isJumping = false;
                }, 50);
            }, 300);
        }

        // Game Over
        function gameOver() {
            isGameOver = true;
            gameOverElement.style.display = 'block';
            clearInterval(gameInterval);
            clearInterval(obstacleInterval);
            clearInterval(cloudInterval);
            clearInterval(phraseInterval);
            setTimeout(showQuestion, 1000);
        }

        // Mostrar pregunta
        function showQuestion() {
            const randomIndex = Math.floor(Math.random() * questions.length);
            const question = questions[randomIndex];
            questionText.textContent = question.question;
            answerOptions.innerHTML = '';
            resultMessage.textContent = '';

            const allAnswers = [question.correctAnswer, ...question.wrongAnswers];
            allAnswers.sort(() => Math.random() - 0.5);

            allAnswers.forEach(answer => {
                const btn = document.createElement('button');
                btn.className = 'answer-btn';
                btn.textContent = answer;
                btn.addEventListener('click', () => checkAnswer(answer, question.correctAnswer));
                answerOptions.appendChild(btn);
            });

            questionModal.style.display = 'flex';
        }

        // Verificar respuesta
        function checkAnswer(selectedAnswer, correctAnswer) {
            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach(btn => {
                if (btn.textContent === correctAnswer) {
                    btn.classList.add('correct');
                } else if (btn.textContent === selectedAnswer && selectedAnswer !== correctAnswer) {
                    btn.classList.add('incorrect');
                }
            });

            if (selectedAnswer === correctAnswer) {
                resultMessage.textContent = '¡Correcto! Continúa jugando.';
                setTimeout(() => {
                    questionModal.style.display = 'none';
                    activateSafeZone();
                    continueGame();
                }, 1500);
            } else {
                wrongAnswersCount++;
                wrongAnswersElement.textContent = wrongAnswersCount;
                resultMessage.textContent = 'Incorrecto.';
                
                // Si alcanza 3 respuestas incorrectas, mostrar animación y reiniciar
                if (wrongAnswersCount >= 3) {
                    setTimeout(() => {
                        questionModal.style.display = 'none';
                        showCubeAnimation();
                    }, 1500);
                } else {
                    setTimeout(() => {
                        questionModal.style.display = 'none';
                        showQuestion();
                    }, 1500);
                }
            }
        }

        // Activar zona segura por 2 segundos
        function activateSafeZone() {
            safeZoneActive = true;
            safeZone.style.display = 'block';
            
            setTimeout(() => {
                safeZoneActive = false;
                safeZone.style.display = 'none';
            }, 2000);
        }

        // Mostrar animación de cubos
        function showCubeAnimation() {
            cubeAnimation.style.display = 'block';
            
            // Crear cubos
            for (let i = 0; i < 50; i++) {
                const cube = document.createElement('div');
                cube.className = 'cube';
                cube.style.left = Math.random() * 100 + 'vw';
                cube.style.animationDelay = Math.random() * 2 + 's';
                cubeAnimation.appendChild(cube);
            }
            
            // Mostrar game over final después de la animación
            setTimeout(() => {
                cubeAnimation.style.display = 'none';
                finalGameOver.style.display = 'flex';
            }, 2500);
        }

        // Continuar juego (elimina obstáculo más cercano)
        function continueGame() {
            isGameOver = false;
            gameOverElement.style.display = 'none';
            
            // Eliminar el obstáculo más cercano
            if (obstacles.length > 0) {
                const closestObstacle = obstacles.reduce((closest, current) => {
                    const closestLeft = parseInt(closest.element.style.left);
                    const currentLeft = parseInt(current.element.style.left);
                    return currentLeft < closestLeft ? current : closest;
                });
                closestObstacle.element.remove();
                obstacles = obstacles.filter(ob => ob !== closestObstacle);
            }
            
            // Reiniciar intervalos
            gameInterval = setInterval(updateGame, 20);
            obstacleInterval = setInterval(createObstacle, 1500);
            cloudInterval = setInterval(createCloud, 3000);
            if (score > 2000) phraseInterval = setInterval(createFallingPhrase, 1500);
        }

        // Pausar/Continuar
        function togglePause() {
            isPaused = !isPaused;
            pauseBtn.textContent = isPaused ? 'Continuar' : 'Pausa';
            if (isPaused) {
                clearInterval(gameInterval);
                clearInterval(obstacleInterval);
                clearInterval(cloudInterval);
                clearInterval(phraseInterval);
            } else {
                gameInterval = setInterval(updateGame, 20);
                obstacleInterval = setInterval(createObstacle, 1500);
                cloudInterval = setInterval(createCloud, 3000);
                if (score > 2000) phraseInterval = setInterval(createFallingPhrase, 1500);
            }
        }

        // Event listeners
        startBtn.addEventListener('click', () => {
            if (!gameStarted) {
                gameStarted = true;
                initGame();
            }
        });

        jumpBtn.addEventListener('click', jump);

        pauseBtn.addEventListener('click', togglePause);

        tapToRestart.addEventListener('click', () => {
            gameStarted = true;
            initGame();
        });

        // Evento de teclado para espacio (iniciar o saltar)
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                if (!gameStarted) {
                    gameStarted = true;
                    initGame();
                } else {
                    jump();
                }
            }
        });

        // Para móviles: touch para saltar
        gameContainer.addEventListener('touchstart', (e) => {
            if (!gameStarted) {
                gameStarted = true;
                initGame();
            } else {
                jump();
            }
        });
    </script>
</body>
</html>